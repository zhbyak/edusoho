webpackJsonp([23],{ZhdM:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s("eqfM");var i=s("/QYm"),n=s("woOf"),r=s.n(n),a=s("fZjL"),o=s.n(a),c=s("Xxa5"),u=s.n(c),l=s("exGp"),d=s.n(l),h=s("Dd8w"),f=s.n(h),p=s("NYxO"),g=s("Du/2"),v=s("gyMJ"),m=s("0Otq"),_={name:"testpaperAnalysis",mixins:[s("mtMv").a],data:function(){return{result:null,items:{},info:[],isReadOver:!1,isWrongMode:!1,allList:[],wrongList:[],wrongType:[],cardSeq:0,cardShow:!1,answer:{},slideIndex:0,canDo:!1}},filters:{type:function(t){switch(t){case"single_choice":return"单选题";case"choice":return"多选题";case"essay":return"问答题";case"uncertain_choice":return"不定项选择题";case"determine":return"判断题";case"fill":return"填空题";case"material":return"材料题"}}},components:{itemBank:m.a},computed:f()({},Object(p.mapState)({isLoading:function(t){return t.isLoading},user:function(t){return t.user}})),created:function(){this.setNavbarTitle(this.$route.query.title),this.getTestpaperResult()},methods:f()({},Object(p.mapMutations)({setNavbarTitle:g.k}),{getTestpaperResult:function(){var e=this;return d()(u.a.mark(function t(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.a.testpaperResult({query:{resultId:e.$route.query.resultId}}).then(function(t){e.result=t.testpaperResult,e.formatData(t),e.isReadOver="finished"===e.result.status,e.result=t.testpaperResult,e.items=t.items});case 2:case"end":return t.stop()}},t,e)}))()},formatData:function(t){var a=this,e=t.items;o()(e).forEach(function(t){"material"!=t&&e[t].forEach(function(t){var e=a.analysisSixType(t.type,t);a.setData(e.item,e.answer)}),"material"==t&&e[t].forEach(function(i){var n=r()({},i,{subs:""});i.subs.forEach(function(t,e){t.parentTitle=n,t.parentType=i.type,t.materialIndex=e+1;var s=a.analysisSixType(t.type,t);a.setData(s.item,s.answer)})})})},setData:function(t,e){if(this.$set(this.answer,t.id,e),this.info.push(t),this.allList.push(t),t.testResult&&"right"!==t.testResult.status||!t.testResult){var s=t.parentType?t.parentType:t.type;this.wrongType.includes(s)||this.wrongType.push(s),this.wrongList.push(t)}},formatStatus:function(t){if(t.testResult)switch(t.testResult.status){case"right":return"cicle-right";case"none":return"cicle-none";case"wrong":case"partRight":return"cicle-wrong";case"noAnswer":return""}},slideToNumber:function(t){var s=this,i=Number(t);this.isWrongMode?this.info.forEach(function(t,e){i===parseInt(t.seq)&&(s.cardSeq=e+1)}):this.cardSeq=i,this.cardShow=!1},showWrongList:function(){0!==this.wrongList.length?(Object(i.a)({message:"切换成功",duration:1e3}),this.isWrongMode=!this.isWrongMode,this.isWrongMode?(this.info=this.wrongList,this.cardSeq=this.isWrongItem()):(this.info=this.allList,this.cardSeq=parseInt(this.wrongList[this.slideIndex].seq)),this.slideIndex=this.cardSeq-1):Object(i.a)("当前没有错题")},isWrongItem:function(){var s=this.allList[this.slideIndex],i=1;return s.testResult&&"right"!==s.testResult.status&&this.wrongList.forEach(function(t,e){t.id==s.id&&(i=e+1)}),i},isWrongType:function(t){return!this.isWrongMode||-1!==this.wrongType.indexOf(t)},isWrongList:function(t){return!this.isWrongMode||t.testResult&&"right"!==t.testResult.status}})},w={render:function(){var s=this,t=s.$createElement,i=s._self._c||t;return i("div",{staticClass:"paper-swiper"},[s.isLoading?i("e-loading"):s._e(),s._v(" "),0<s.info.length?i("item-bank",{attrs:{isWrongMode:s.isWrongMode,current:s.cardSeq,info:s.info,answer:s.answer,slideIndex:s.slideIndex,canDo:s.canDo,all:s.allList.length},on:{"update:current":function(t){s.cardSeq=t},"update:slideIndex":function(t){s.slideIndex=t}}}):s._e(),s._v(" "),i("div",{staticClass:"paper-footer"},[i("div",[i("span",{on:{click:function(t){s.cardShow=!0}}},[i("i",{staticClass:"iconfont icon-Questioncard"}),s._v("\n        题卡\n      ")])]),s._v(" "),i("div",[i("span",{class:{"footer__div__span--active":s.isWrongMode},on:{click:s.showWrongList}},[i("i",{staticClass:"cuoti"},[i("img",{attrs:{src:s.isWrongMode?"static/images/cuoti-active.png":"static/images/cuoti.png",alt:""}})]),s._v("\n        错题\n      ")])])]),s._v(" "),i("van-popup",{attrs:{position:"bottom"},model:{value:s.cardShow,callback:function(t){s.cardShow=t},expression:"cardShow"}},[0<s.info.length?i("div",{staticClass:"card"},[i("div",{staticClass:"card-title"},[i("div",[i("span",{staticClass:"card-right"},[s._v("正确")]),s._v(" "),i("span",{staticClass:"card-wrong"},[s._v("错误")]),s._v(" "),i("span",{staticClass:"card-nofinish"},[s._v("未作答")]),s._v(" "),s.isReadOver?s._e():i("span",{staticClass:"card-none"},[s._v("待批阅")])]),s._v(" "),i("i",{staticClass:"iconfont icon-no",on:{click:function(t){s.cardShow=!1}}})]),s._v(" "),i("div",{staticClass:"card-list"},s._l(s.items,function(t,e){return s.isWrongType(e)?i("div",{key:e,staticClass:"card-item"},[i("div",{staticClass:"card-item-title"},[s._v(s._s(s._f("type")(e)))]),s._v(" "),"material"!=e?i("div",{staticClass:"card-item-list"},s._l(s.items[e],function(e){return s.isWrongList(e)?i("div",{key:e.id,class:["list-cicle",s.formatStatus(e)],on:{click:function(t){s.slideToNumber(e.seq)}}},[s._v(s._s(e.seq))]):s._e()})):s._e(),s._v(" "),"material"==e?i("div",{staticClass:"card-item-list"},[s._l(s.items[e],function(t){return s._l(t.subs,function(e){return s.isWrongList(e)?i("div",{key:e.id,class:["list-cicle",s.formatStatus(e)],on:{click:function(t){s.slideToNumber(e.seq)}}},[s._v(s._s(e.seq))]):s._e()})})],2):s._e()]):s._e()}))]):s._e()])],1)},staticRenderFns:[]};var y=s("VU/8")(_,w,!1,function(t){s("wG9d")},null,null);e.default=y.exports},wG9d:function(t,e){}});