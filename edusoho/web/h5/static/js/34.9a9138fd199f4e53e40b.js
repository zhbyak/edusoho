webpackJsonp([34],{rmiZ:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var s=t("Dd8w"),a=t.n(s),i=t("Xxa5"),o=t.n(i),r=t("exGp"),c=t.n(r),l=t("FVyg"),u=(t("SgDA"),t("KFVb"),t("gyMJ")),m=t("NyOD"),d=t("1JqO"),g=t("L/LV"),v=t("NYxO"),p={name:"fast-login",mixins:[m.a,d.a,g.a],components:{EDrag:l.a},data:function(){return{userinfo:{mobile:"",dragCaptchaToken:void 0,smsCode:"",smsToken:"",type:"sms_login"},userTerms:!1,privacyPolicy:!1,registerSettings:null,agreement:!0,dragEnable:!1,dragKey:0,errorMessage:{mobile:""},validated:{mobile:!1}}},computed:{btnDisable:function(){return!(this.userinfo.mobile&&this.userinfo.smsCode&&this.agreement)}},created:function(){var n=this;return c()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.$store.state.token)return Toast.loading({message:"请稍后"}),n.afterLogin(),e.abrupt("return");e.next=4;break;case 4:n.getPrivacySetting();case 5:case"end":return e.stop()}},e,n)}))()},methods:a()({},Object(v.mapActions)(["addUser","setMobile","sendSmsSend","fastLogin"]),{getPrivacySetting:function(){var n=this;return c()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.getSettings({query:{type:"user"}}).then(function(e){e.auth.user_terms_enabled&&(n.userTerms=!0),e.auth.privacy_policy_enabled&&(n.privacyPolicy=!0)}).catch(function(e){Toast.fail(e.message)});case 2:n.registerSettings=e.sent;case 3:case"end":return e.stop()}},e,n)}))()},lookPrivacyPolicy:function(){window.location.href=window.location.origin+"/mapi_v2/School/getPrivacyPolicy"},handleSmsSuccess:function(e){this.userinfo.dragCaptchaToken=e,this.handleSendSms()},handleSubmitSuccess:function(){this.afterLogin()},checkAgree:function(){this.agreement=!this.agreement},changeLogin:function(){this.$router.push({name:"login"})}})},f={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"login"},[t("span",{staticClass:"login-title"},[n._v("手机快捷登录")]),n._v(" "),t("span",{staticClass:"login-des"},[n._v("新用户将为您自动注册")]),n._v(" "),t("van-field",{staticClass:"login-input e-input",attrs:{placeholder:"请输入手机号",maxLength:"11",type:"number",border:!1,clearable:"","error-message":n.errorMessage.mobile},on:{blur:function(e){n.validateMobileOrPsw("mobile")},keyup:function(e){n.validatedChecker()}},model:{value:n.userinfo.mobile,callback:function(e){n.$set(n.userinfo,"mobile",e)},expression:"userinfo.mobile"}}),n._v(" "),n.dragEnable?t("e-drag",{key:n.dragKey,ref:"dragComponent",attrs:{limitType:"sms_login"},on:{success:n.handleSmsSuccess}}):n._e(),n._v(" "),t("van-field",{ref:"smsCode",staticClass:"login-input e-input",attrs:{type:"number",border:!1,center:"",clearable:"",maxLength:"6",placeholder:"请输入验证码"},model:{value:n.userinfo.smsCode,callback:function(e){n.$set(n.userinfo,"smsCode",e)},expression:"userinfo.smsCode"}},[t("van-button",{attrs:{slot:"button",size:"small",type:"primary",disabled:n.count.codeBtnDisable||!n.validated.mobile},on:{click:n.clickSmsBtn},slot:"button"},[n._v("\n      发送验证码\n      "),t("span",{directives:[{name:"show",rawName:"v-show",value:n.count.showCount,expression:"count.showCount"}]},[n._v("("+n._s(n.count.num)+")")])])],1),n._v(" "),t("van-button",{staticClass:"primary-btn mb20",attrs:{type:"default",disabled:n.btnDisable},on:{click:function(e){n.handleSubmit(n.handleSubmitSuccess)}}},[n._v("登录")]),n._v(" "),t("div",{staticClass:"login-bottom text-center"},[n.userTerms||n.privacyPolicy?t("div",{staticClass:"login-agree"},[t("van-checkbox",{attrs:{"checked-color":"#408ffb","icon-size":16},on:{click:n.checkAgree},model:{value:n.agreement,callback:function(e){n.agreement=e},expression:"agreement"}}),n._v("\n      我已阅读并同意"),n.userTerms?t("i",{on:{click:n.lookPrivacyPolicy}},[n._v("《用户服务》")]):n._e(),n.userTerms&&n.privacyPolicy?t("span",[n._v("和")]):n._e(),n.privacyPolicy?t("span",[n._v("《"),t("i",{on:{click:n.lookPrivacyPolicy}},[n._v("隐私协议")]),n._v("》")]):n._e()],1):n._e(),n._v(" "),t("div",{staticClass:"login-change",on:{click:n.changeLogin}},[t("img",{staticClass:"login_change-icon",attrs:{src:"static/images/login_change.png"}}),n._v("切换账号密码登录\n    ")])])],1)},staticRenderFns:[]},b=t("VU/8")(p,f,!1,null,null,null);n.default=b.exports}});