webpackJsonp(["app/js/open-course/header/index"],{"73a109fead0f08f835ed":function(e,r,i){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}var n=i("ef77ea6623b706a87a55"),a=t(n),o=i("c04c1b91e3806f24595a");t(o),i("9181c6995ae8c5c94b7a");if($("#firstLesson").length>0){new a.default({url:$("#firstLesson").data("url"),element:".open-course-views"})}},"87fce900c1efe27f8ef1":function(e,r,i){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=i("7ab4a89ebadbfdecc2bf"),a=t(n),o=i("4602c3f5fe7ad9e3e91d"),l=t(o),s=function(){function e(r){var i=r.element,t=r.courseUrl;(0,a.default)(this,e),this.$element=$(i),this.courseUrl=t,this.init()}return(0,l.default)(e,[{key:"init",value:function(){var e=this,r="";$.get(this.courseUrl).then(function(i){i.map(function(i){r+=e.template(i.id,i.cover,i.title)}),e.$element.find(".modal-body").html(r)})}},{key:"isWxAndroidBrowser",value:function(){var e=navigator.userAgent.toLowerCase();return/android/.test(e)&&/micromessenger/i.test(e)}},{key:"isWxPreviewType",value:function(){return this.$element.parent(".js-open-course-wechat-preview").length>0}},{key:"template",value:function(e,r,i){return'<div class="modal-img">\n        <a href="/course_set/'+e+'">\n          <img class="img-responsive" src="'+r.middle+'" alt="">\n        </a>\n        <div class="title"><a class="link-dark" href="/course_set/'+e+'">'+i+"</a></div>\n      </div>"}},{key:"show",value:function(){this.isWxPreviewType()||(this.isWxAndroidBrowser()&&(document.getElementById("viewerIframe").contentWindow.document.getElementById("lesson-player").style.display="none",this.$element.on("hide.bs.modal",function(){document.getElementById("viewerIframe").contentWindow.document.getElementById("lesson-player").style.display="block"})),this.$element.modal({backdrop:!1}))}},{key:"hide",value:function(){this.$element.modal("hide")}}]),e}();r.default=s},ef77ea6623b706a87a55:function(e,r,i){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var n=i("7ab4a89ebadbfdecc2bf"),a=t(n),o=i("4602c3f5fe7ad9e3e91d"),l=t(o),s=i("06597b47670159844043"),d=t(s),u=i("c04c1b91e3806f24595a"),c=t(u),f=i("efee0f06e7253583ba8a"),m=i("87fce900c1efe27f8ef1"),v=t(m),h=function(){function e(r){var i=r.url,t=r.element;(0,a.default)(this,e),this.url=i,this.$element=$(t),this.player=null,this.lesson=null,this.courseAd=null,this.init(),this.initEvent()}return(0,l.default)(e,[{key:"init",value:function(){this.showPlayer()}},{key:"initEvent",value:function(){var e=this;this.$element.on("click",".js-player-replay",function(r){return e.replay(r)}),this.$element.on("click",".js-live-video-replay-btn",function(r){return e.onLiveVideoPlay(r)})}},{key:"showPlayer",value:function(){var e=this;$.get(this.url,function(r){if(r.mediaError)return $("#media-error-dialog").show(),void $("#media-error-dialog").find(".modal-body .media-error").html(r.mediaError);$("#media-error-dialog").hide(),e.lesson=r,$(".js-live-video-replay-btn").removeClass("hidden");var i={iframe:e.onIframe,self:e.onVideo},t=i[r.mediaSource]?i[r.mediaSource].bind(e):void 0;void 0!==t||"video"!=r.type&&"audio"!=r.type||(t=e.onSWF.bind(e)),void 0!==t&&t(e)})}},{key:"onIframe",value:function(){var e=$("#lesson-preview-iframe");e.empty();var r='<iframe class="embed-responsive-item" src="'+this.lesson.mediaUri+'" style="position:absolute; left:0; top:0; height:100%; width:100%; border:0px;" scrolling="no"></iframe>';e.html(r),e.show()}},{key:"onVideo",value:function(){if("flash"===(0,f.getSupportedPlayer)())return void this.flashTip();var e=this.lesson;if("video"==e.type||"audio"==e.type){if("success"!=e.convertStatus&&"cloud"==e.storage)return $("#media-error-dialog").show(),void $("#media-error-dialog").find(".modal-body .media-error").html(Translator.trans("open_course.converting_hint"));var r="/open/course/"+e.courseId+"/lesson/"+e.id+"/player";this.videoPlay(r)}}},{key:"onSWF",value:function(){if(!c.default.hasFlashPlayerVersion("11"))return void this.flashTip();var e=this.lesson,r=$("#lesson-preview-swf-player");c.default.removeSWF("lesson-preview-swf-player"),r.html('<div id="lesson-swf-player"></div>'),c.default.embedSWF(e.mediaUri,"lesson-swf-player","100%","100%","9.0.0",null,null,{wmode:"opaque",allowFullScreen:"true"}),r.show()}},{key:"replay",value:function(){this.player?(this.player.replay(),this.courseAd.hide()):window.location.reload()}},{key:"onLiveVideoPlay",value:function(e){this.$element.find(".js-live-header-mask").hide();var r=$(e.currentTarget),i=this.lesson;if(i.mediaError)return $("#media-error-dialog").show(),void $("#media-error-dialog").find(".modal-body .media-error").html(i.mediaError);if($("#media-error-dialog").hide(),"liveOpen"==i.type&&"videoGenerated"==i.replayStatus){if("success"!=i.convertStatus&&"cloud"==i.storage)return $("#media-error-dialog").show(),void $("#media-error-dialog").find(".modal-body .media-error").html(Translator.trans("open_course.converting_hint"));var t=r.data("referer"),n="/open/course/"+i.courseId+"/lesson/"+i.id+"/player?referer="+t;this.videoPlay(n)}}},{key:"getPlayer",value:function(){return window.frames.viewerIframe.window.BalloonVideoPlayer||window.frames.viewerIframe.window.player}},{key:"videoPlay",value:function(e){var r=this,i=$("#lesson-preview-player");i.html("");var t='<iframe \n      class="embed-responsive-item" \n      src="'+e+'" \n      name="viewerIframe" \n      id="viewerIframe" \n      width="100%" \n      allowfullscreen \n      webkitallowfullscreen \n      height="100%"" \n      style="border:0px;position:absolute; left:0; top:0;"></iframe>';i.html(t).show();var n=new d.default({name:"parent",project:"PlayerProject",children:[document.getElementById("viewerIframe")],type:"parent"});n.on("ready",function(){var e=r.getPlayer();r.player=e}),n.on("ended",function(){r.onPlayEnd()})}},{key:"onPlayEnd",value:function(){this.showADModal()}},{key:"showADModal",value:function(){if(this.courseAd)return void this.courseAd.show();this.courseAd=new v.default({element:"#open-course-ad-modal",courseUrl:this.$element.data("get-recommend-course-url")}),this.courseAd.show()}},{key:"flashTip",value:function(e){var r='\n    <div class="alert alert-warning alert-dismissible fade in" role="alert">\n      <button type="button" class="close" data-dismiss="alert" aria-label="Close">\n      <span aria-hidden="true">Ã—</span>\n      </button>\n      '+Translator.trans("site.flash_not_install_hint")+"\n    </div>";$("#lesson-preview-swf-player").html(r).show()}}]),e}();r.default=h},efee0f06e7253583ba8a:function(e,r,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=function(){var e=document.createElement("video");return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(r){return/maybe|probably/i.test(e.canPlayType(r))})},n=function(){var e={};if(e.ie9=/MSIE\s+9.0/i.test(navigator.userAgent),e.ie10=/MSIE\s+10.0/i.test(navigator.userAgent),e.ie11=/Trident\/7\./.test(navigator.userAgent),e.edge=/Edge\/13./i.test(navigator.userAgent),e.ie9||e.ie10||e.ie11||e.edge)return!0};r.getSupportedPlayer=function(){return t()?"native":window.MediaSource?"hls":!!n()&&"flash"}}},["73a109fead0f08f835ed"]);