webpackJsonp(["app/js/mobile-bind/index"],{0:function(e,t){e.exports=jQuery},"5844f90fb4369f71479a":function(e,t,a){"use strict";var s=a("90115c5fc1df75f99ef1");new(function(e){return e&&e.__esModule?e:{default:e}}(s).default)},"90115c5fc1df75f99ef1":function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a("7ab4a89ebadbfdecc2bf"),d=s(i),n=a("4602c3f5fe7ad9e3e91d"),r=s(n),o=a("0282bb17fb83bfbfed9b"),u=s(o),c=a("fe53252afd7b6c35cb73"),f=s(c),l=a("b334fd7e4c5a19234db2"),b=s(l),m=a("bbc0ef257199acca9fed"),h=s(m),g=function(){function e(){(0,d.default)(this,e),this.$form=$("#mobile-bind-form"),this.$smsCode=this.$form.find(".js-sms-send"),this.drag=null,this.initCheckCookie(),this.dragEvent(),this.initValidator(),this.initMobileCodeSendBtn()}return(0,r.default)(e,[{key:"dragEvent",value:function(){var e=this;this.drag&&this.drag.on("success",function(t){e.$smsCode.removeClass("disabled").attr("disabled",!1)})}},{key:"initCheckCookie",value:function(){var e=this.$form.data("userId")+"-last-login-in";f.default.get(e)&&f.default.get(e)==(new Date).getDate()||(this.drag=$("#drag-btn").length?new h.default($("#drag-btn"),$(".js-jigsaw"),{limitType:"web_register"}):null,$("#mobile-bind-modal").modal("show"),f.default.set(e,(new Date).getDate()))}},{key:"initValidator",value:function(){var e=this;this.validator=this.$form.validate({currentDom:"#submit-btn",ajax:!0,rules:{password:{required:!0,es_remote:{type:"post"}},mobile:{required:!0,phone:!0,es_remote:{type:"get",callback:function(t){t?e.$smsCode.removeAttr("disabled"):e.$smsCode.attr("disabled",!0)}}},sms_code:{required:!0,unsigned_integer:!0,es_remote:{type:"get"}}},messages:{sms_code:{required:Translator.trans("site.captcha_code.required")}},submitSuccess:function(e){(0,b.default)("success",Translator.trans(e.message)),$(".modal").modal("hide")},submitError:function(e){(0,b.default)("danger",Translator.trans(e.responseJSON.message))}})}},{key:"initMobileCodeSendBtn",value:function(){var e=this;this.$smsCode.on("click",function(){e.$smsCode.attr("disabled",!0),new u.default({element:".js-sms-send",url:e.$smsCode.data("url"),smsType:"sms_bind",captcha:!0,captchaValidated:!0,captchaNum:"dragCaptchaToken",preSmsSend:function(){return!0},error:function(t){e.drag.initDragCaptcha()},additionalAction:function(t){return"captchaRequired"==t&&(e.$smsCode.attr("disabled",!0),$(".js-drag-jigsaw").removeClass("hidden"),e.drag&&e.drag.initDragCaptcha(),!0)}})})}}]),e}();t.default=g}},["5844f90fb4369f71479a"]);