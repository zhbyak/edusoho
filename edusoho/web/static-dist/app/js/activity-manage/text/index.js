webpackJsonp(["app/js/activity-manage/text/index"],{"1d0e3cb29c694c31b1b6":function(t,e,a){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a("7ab4a89ebadbfdecc2bf"),r=i(n),o=a("4602c3f5fe7ad9e3e91d"),c=i(o),l=a("6ff75de42f89cafb6c75");a("d5e8fa5f17ac5fe79c78");var d=function(){function t(e){(0,r.default)(this,t),this._init()}return(0,c.default)(t,[{key:"_init",value:function(){var t=this;this._inItStep2form(),this._inItStep3form(),this._lanuchAutoSave(),$(".js-continue-edit").on("click",function(e){var a=$(e.currentTarget),i=a.data("content");t.editor.setData(i),a.remove()})}},{key:"_inItStep2form",value:function(){var t=$("#step2-form"),e=t.data("validator");e=t.validate({rules:{title:{required:!0,maxlength:50,trim:!0,course_title:!0},content:{required:!0,trim:!0}}});var a=$('[name="content"]');this.editor=(0,l.initEditor)(a,e),this._contentCache=a.val()}},{key:"_lanuchAutoSave",value:function(){var t=this,e=$("#modal .modal-title",parent.document);this._originTitle=e.text(),setInterval(function(){t._saveDraft()},5e3)}},{key:"_saveDraft",value:function(){var t=this,e=this.editor.getData();if(e!==this._contentCache){var a=$('[name="content"]');$.post(a.data("saveDraftUrl"),{content:e}).done(function(){var a=new Date,i=$("#modal .modal-title",parent.document),n=Translator.trans("site.date_format_his",{hours:a.getHours(),minutes:a.getMinutes(),seconds:a.getSeconds()});i.text(t._originTitle+Translator.trans("activity.text_manage.save_draft_hint",{createdTime:n})),t._contentCache=e})}}},{key:"_inItStep3form",value:function(){var t=$("#step3-form");t.data("validator");t.validate({rules:{finishDetail:{required:!0,positive_integer:!0,max:300}},messages:{finishDetail:{required:Translator.trans("activity.text_manage.finish_detail_required_error_hint")}}})}}]),t}();e.default=d},"2900dc3202017a9ddf44":function(t,e,a){"use strict";var i=a("1d0e3cb29c694c31b1b6");new(function(t){return t&&t.__esModule?t:{default:t}}(i).default)},"6ff75de42f89cafb6c75":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.initEditor=function(t,e){var a=CKEDITOR.replace("text-content-field",{toolbar:"Task",fileSingleSizeLimit:app.fileSingleSizeLimit,filebrowserImageUploadUrl:$("#text-content-field").data("imageUploadUrl"),filebrowserFlashUploadUrl:$("#text-content-field").data("flashUploadUrl"),allowedContent:!0,height:300});return a.on("change",function(){t.val(a.getData()),e&&e.form()}),a.on("blur",function(){t.val(a.getData()),e&&e.form()}),a}}},["2900dc3202017a9ddf44"]);