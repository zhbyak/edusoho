webpackJsonp(["app/js/auth/password-reset/index"],{0:function(e,r){e.exports=jQuery},"8fe9b6e117bbb964d58b":function(e,r,a){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}var s=a("7ab4a89ebadbfdecc2bf"),n=t(s),o=a("4602c3f5fe7ad9e3e91d"),d=t(o),i=a("0282bb17fb83bfbfed9b"),c=(t(i),a("bbc0ef257199acca9fed")),l=t(c),u=a("5eb223de522186da1dd9"),f=t(u),h=a("b334fd7e4c5a19234db2"),m=t(h),g=a("971935e6d9dafc951b13");a("9415ea13985847610e60"),new(function(){function e(){(0,n.default)(this,e),this.event(),this.dragHtml=$(".js-drag-box").html(),$(".js-drag-box").remove(),$("#password-reset-form").prepend(this.dragHtml),this.drag=new l.default($("#drag-btn"),$(".js-jigsaw"),{limitType:"reset_password"}),this.smsEvent(),this.validator(),this.smsToken=""}return(0,d.default)(e,[{key:"event",value:function(){var e=this;$(".js-find-password li").click(function(){var r=$(this);if(!r.hasClass("active")){r.addClass("active").siblings().removeClass("active");var a=$(r.data("target"));a.length>0&&($("form").hide(),e.drag.unbindEvent(),$(".js-drag").remove(),a.prepend(e.dragHtml),e.drag=new l.default($("#drag-btn"),$(".js-jigsaw"),{limitType:"reset_password"}),a.show())}})}},{key:"smsEvent",value:function(){var e=this,r=$(".js-sms-send"),a=this;r.click(function(){if(e.mobileValidator.element($('[name="dragCaptchaToken"]'))){if(r.hasClass("disabled"))return;r.addClass("disabled"),f.default.resetPasswordSms.get({params:{mobile:$("#mobile").val()},data:{dragCaptchaToken:$('[name="dragCaptchaToken"]').val()}}).then(function(e){(0,m.default)("success",Translator.trans("notify.sms_send_success.message")),r.removeClass("disabled"),(0,g.countDown)($(".js-sms-send"),$("#js-fetch-btn-text"),120),a.smsToken=e.smsToken}).catch(function(){r.removeClass("disabled"),a.drag.initDragCaptcha()})}})}},{key:"validator",value:function(){var e=this;$("#password-reset-form").validate({rules:{email:{required:!0,email:!0},dragCaptchaToken:{required:!0}},messages:{dragCaptchaToken:{required:Translator.trans("site.captcha_code.required")}},submitHandler:function(r){var a=$("#password-reset-form").find('[name="email"]').val();f.default.resetPasswordEmail.patch({params:{email:a},data:{dragCaptchaToken:$('[name="dragCaptchaToken"]').val()}}).then(function(e){(0,m.default)("success",Translator.trans("notify.password_reset_email_send_success.message")),window.location.href=$("#password-reset-form").data("success")+"?email="+a}).catch(function(r){4040104==(r.responseJSON.error.code||0)&&e.drag.initDragCaptcha()})}}),$.validator.addMethod("passwordSms",function(r,a){var t=!1;return f.default.resetPasswordSms.validate({params:{mobile:$("#mobile").val(),smsCode:$("#sms-code").val()},data:{smsToken:e.smsToken},async:!1,promise:!1}).success(function(e){t="sms.code.success"==e}),t},$.validator.format(Translator.trans("validate.sms_code.message"))),this.mobileValidator=$("#password-reset-by-mobile-form").validate({rules:{mobile:{required:!0,phone:!0,es_remote:{type:"get",callback:function(e){e?$(".js-sms-send").removeClass("disabled"):$(".js-sms-send").addClass("disabled")}}},sms_code:{required:!0,unsigned_integer:!0,rangelength:[6,6],passwordSms:!0},dragCaptchaToken:{required:!0},reset_password:{required:!0,minlength:5,maxlength:20}},messages:{sms_code:{required:Translator.trans("auth.password_reset.sms_code_required_hint"),rangelength:Translator.trans("auth.password_reset.sms_code_validate_hint")},dragCaptchaToken:{required:Translator.trans("site.captcha_code.required")}},submitHandler:function(r){f.default.resetPasswordMobile.patch({params:{mobile:$("#mobile").val()},data:{smsToken:e.smsToken,smsCode:$("#sms-code").val(),encrypt_password:window.XXTEA.encryptToBase64($("#reset_password").val(),window.location.host),dragCaptchaToken:$('[name="dragCaptchaToken"]').val()}}).then(function(e){(0,m.default)("success",Translator.trans("notify.password_reset_success.message")),window.location.href=$("#password-reset-form").data("success")+"?mobile="+$("#mobile").val()})}})}}]),e}())},"9415ea13985847610e60":function(e,r,a){"use strict";!function(e){function r(e,r){var a=e.length,t=a<<2;if(r){var s=e[a-1];if(t-=4,s<t-3||s>t)return null;t=s}for(var n=0;n<a;n++)e[n]=String.fromCharCode(255&e[n],e[n]>>>8&255,e[n]>>>16&255,e[n]>>>24&255);var o=e.join("");return r?o.substring(0,t):o}function a(e,r){var a=e.length,t=a>>2;0!=(3&a)&&++t;var s;r?(s=new Array(t+1),s[t]=a):s=new Array(t);for(var n=0;n<a;++n)s[n>>2]|=e.charCodeAt(n)<<((3&n)<<3);return s}function t(e){return 4294967295&e}function s(e,r,a,t,s,n){return(a>>>5^r<<2)+(r>>>3^a<<4)^(e^r)+(n[3&t^s]^a)}function n(e){return e.length<4&&(e.length=4),e}function o(e,r){var a,n,o,d,i,c,l=e.length,u=l-1;for(n=e[u],o=0,c=0|Math.floor(6+52/l);c>0;--c){for(o=t(o+v),d=o>>>2&3,i=0;i<u;++i)a=e[i+1],n=e[i]=t(e[i]+s(o,a,n,i,d,r));a=e[0],n=e[u]=t(e[u]+s(o,a,n,u,d,r))}return e}function d(e,r){var a,n,o,d,i,c,l=e.length,u=l-1;for(a=e[0],c=Math.floor(6+52/l),o=t(c*v);0!==o;o=t(o-v)){for(d=o>>>2&3,i=u;i>0;--i)n=e[i-1],a=e[i]=t(e[i]-s(o,a,n,i,d,r));n=e[u],a=e[0]=t(e[0]-s(o,a,n,0,d,r))}return e}function i(e){if(/^[\x00-\x7f]*$/.test(e))return e;for(var r=[],a=e.length,t=0,s=0;t<a;++t,++s){var n=e.charCodeAt(t);if(n<128)r[s]=e.charAt(t);else if(n<2048)r[s]=String.fromCharCode(192|n>>6,128|63&n);else{if(!(n<55296||n>57343)){if(t+1<a){var o=e.charCodeAt(t+1);if(n<56320&&56320<=o&&o<=57343){var d=65536+((1023&n)<<10|1023&o);r[s]=String.fromCharCode(240|d>>18&63,128|d>>12&63,128|d>>6&63,128|63&d),++t;continue}}throw new Error("Malformed string")}r[s]=String.fromCharCode(224|n>>12,128|n>>6&63,128|63&n)}}return r.join("")}function c(e,r){for(var a=new Array(r),t=0,s=0,n=e.length;t<r&&s<n;t++){var o=e.charCodeAt(s++);switch(o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a[t]=o;break;case 12:case 13:if(!(s<n))throw new Error("Unfinished UTF-8 octet sequence");a[t]=(31&o)<<6|63&e.charCodeAt(s++);break;case 14:if(!(s+1<n))throw new Error("Unfinished UTF-8 octet sequence");a[t]=(15&o)<<12|(63&e.charCodeAt(s++))<<6|63&e.charCodeAt(s++);break;case 15:if(!(s+2<n))throw new Error("Unfinished UTF-8 octet sequence");var d=((7&o)<<18|(63&e.charCodeAt(s++))<<12|(63&e.charCodeAt(s++))<<6|63&e.charCodeAt(s++))-65536;if(!(0<=d&&d<=1048575))throw new Error("Character outside valid Unicode range: 0x"+d.toString(16));a[t++]=d>>10&1023|55296,a[t]=1023&d|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+o.toString(16))}}return t<r&&(a.length=t),String.fromCharCode.apply(String,a)}function l(e,r){for(var a=[],t=new Array(32768),s=0,n=0,o=e.length;s<r&&n<o;s++){var d=e.charCodeAt(n++);switch(d>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t[s]=d;break;case 12:case 13:if(!(n<o))throw new Error("Unfinished UTF-8 octet sequence");t[s]=(31&d)<<6|63&e.charCodeAt(n++);break;case 14:if(!(n+1<o))throw new Error("Unfinished UTF-8 octet sequence");t[s]=(15&d)<<12|(63&e.charCodeAt(n++))<<6|63&e.charCodeAt(n++);break;case 15:if(!(n+2<o))throw new Error("Unfinished UTF-8 octet sequence");var i=((7&d)<<18|(63&e.charCodeAt(n++))<<12|(63&e.charCodeAt(n++))<<6|63&e.charCodeAt(n++))-65536;if(!(0<=i&&i<=1048575))throw new Error("Character outside valid Unicode range: 0x"+i.toString(16));t[s++]=i>>10&1023|55296,t[s]=1023&i|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+d.toString(16))}if(s>=32766){var c=s+1;t.length=c,a[a.length]=String.fromCharCode.apply(String,t),r-=c,s=-1}}return s>0&&(t.length=s,a[a.length]=String.fromCharCode.apply(String,t)),a.join("")}function u(e,r){return(void 0===r||null===r||r<0)&&(r=e.length),0===r?"":/^[\x00-\x7f]*$/.test(e)||!/^[\x00-\xff]*$/.test(e)?r===e.length?e:e.substr(0,r):r<65535?c(e,r):l(e,r)}function f(e,t){return void 0===e||null===e||0===e.length?e:(e=i(e),t=i(t),r(o(a(e,!0),n(a(t,!1))),!1))}function h(r,a){return e.btoa(f(r,a))}function m(e,t){return void 0===e||null===e||0===e.length?e:(t=i(t),u(r(d(a(e,!1),n(a(t,!1))),!0)))}function g(r,a){return void 0===r||null===r||0===r.length?r:m(e.atob(r),a)}void 0===e.btoa&&(e.btoa=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return function(r){var a,t,s,n,o,d,i;for(t=s=0,n=r.length,o=n%3,n-=o,d=n/3<<2,o>0&&(d+=4),a=new Array(d);t<n;)i=r.charCodeAt(t++)<<16|r.charCodeAt(t++)<<8|r.charCodeAt(t++),a[s++]=e[i>>18]+e[i>>12&63]+e[i>>6&63]+e[63&i];return 1==o?(i=r.charCodeAt(t++),a[s++]=e[i>>2]+e[(3&i)<<4]+"=="):2==o&&(i=r.charCodeAt(t++)<<8|r.charCodeAt(t++),a[s++]=e[i>>10]+e[i>>4&63]+e[(15&i)<<2]+"="),a.join("")}}()),void 0===e.atob&&(e.atob=function(){var e=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];return function(r){var a,t,s,n,o,d,i,c,l,u;if((i=r.length)%4!=0)return"";if(/[^ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\+\/\=]/.test(r))return"";for(c="="==r.charAt(i-2)?1:"="==r.charAt(i-1)?2:0,l=i,c>0&&(l-=4),l=3*(l>>2)+c,u=new Array(l),o=d=0;o<i&&-1!=(a=e[r.charCodeAt(o++)])&&-1!=(t=e[r.charCodeAt(o++)])&&(u[d++]=String.fromCharCode(a<<2|(48&t)>>4),-1!=(s=e[r.charCodeAt(o++)]))&&(u[d++]=String.fromCharCode((15&t)<<4|(60&s)>>2),-1!=(n=e[r.charCodeAt(o++)]));)u[d++]=String.fromCharCode((3&s)<<6|n);return u.join("")}}());var v=2654435769;e.XXTEA={utf8Encode:i,utf8Decode:u,encrypt:f,encryptToBase64:h,decrypt:m,decryptFromBase64:g}}(window)},"971935e6d9dafc951b13":function(e,r,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.countDown=function e(r,a,t){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};if(r.addClass("disabled").attr("disabled",!0),a.data("count-down-text")||a.data("count-down-text",a.text()),a.text(t+" 秒后重新获取"),--t<0)return r.removeClass("disabled").attr("disabled",!1),a.text(a.data("count-down-text")),void s();setTimeout(function(){e(r,a,t,s)},1e3)}}},["8fe9b6e117bbb964d58b"]);