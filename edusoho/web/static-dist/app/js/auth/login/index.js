webpackJsonp(["app/js/auth/login/index"],{"15922bb71c26e0956957":function(e,s,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(s,"__esModule",{value:!0});var t=i("7ab4a89ebadbfdecc2bf"),o=n(t),a=i("4602c3f5fe7ad9e3e91d"),d=n(a),l=function(){function e(s){(0,o.default)(this,e),this.options=s,this.$element=this.options.element,this.$loginDom=$(".js-sts-login"),this.init()}return(0,d.default)(e,[{key:"init",value:function(){this.bindEvent(),this.closeModal()}},{key:"bindEvent",value:function(){var e=this;this.$loginDom.on("click",".js-login-back",function(){return e.back()}),this.$loginDom.on("click",".js-invalid-btn",function(){return e.refresh()}),this.$loginDom.on("click",".js-approve-again-btn",function(){return e.approveAgain()}),this.$element.on("click",".js-sts-login-link",function(){return e.showQrcode()})}},{key:"back",value:function(){$(".js-approve-ing, .js-feedback, .js-sts-login").addClass("hidden"),this.options.target?this.$element.find(this.options.target).removeClass("hidden"):this.$element.removeClass("hidden")}},{key:"showQrcode",value:function(){var e=this;$.ajax({type:"post",url:this.$loginDom.data("url"),dataType:"json",success:function(s){e.$loginDom.find(".js-sts-login-qrcode img").attr("src",s.qrcode),e.onlyShow(),e.token=s.token,e.pollStatus()}})}},{key:"approveAgain",value:function(){$(".js-feedback").addClass("hidden"),$(".js-login-section, .js-sts-tip").removeClass("hidden"),this.refresh()}},{key:"refresh",value:function(){$(".js-approve-ing").addClass("hidden"),this.showQrcode()}},{key:"pollStatus",value:function(){var e=this,s=this.token,i=this.$loginDom.data("goto"),n=$(".js-fail-feedback"),t=$(".js-success-feedback"),o=$(".js-fail-tip"),a=$(".js-approve-again-btn");this.$loginDom.hasClass("hidden")||this.flag||$.get("/login/face_token/"+s,{goto:i},function(s){switch(s.status){case"created":setTimeout(function(){e.pollStatus()},2e3);break;case"processing":$(".js-invalid-btn").addClass("hidden"),$(".js-approve-ing, .js-approve-ing-tip").removeClass("hidden"),setTimeout(function(){e.pollStatus()},2e3);break;case"expired":$(".js-approve-ing-tip").addClass("hidden"),$(".js-approve-ing, .js-invalid-btn").removeClass("hidden");break;case"successed":e.statusShow(),t.removeClass("hidden").siblings().addClass("hidden"),window.location.href=s.url;break;case"failed":e.feedbackShow(n,a,o);break;case"failures":e.feedbackShow(n,o,a)}})}},{key:"closeModal",value:function(){var e=this;$("#login-modal").on("hide.bs.modal",function(){e.flag=!0})}},{key:"onlyShow",value:function(){$(".js-sts-login, .js-login-section, .js-sts-tip").removeClass("hidden"),this.options.target?this.$element.find(this.options.target).addClass("hidden"):this.$element.addClass("hidden")}},{key:"statusShow",value:function(){$(".js-login-section, .js-sts-tip").addClass("hidden"),$(".js-feedback").removeClass("hidden")}},{key:"feedbackShow",value:function(e,s,i){this.statusShow(),e.removeClass("hidden").siblings().addClass("hidden"),s.removeClass("hidden"),i.addClass("hidden")}}]),e}();s.default=l},e821b9436177d7c7ef64:function(e,s,i){"use strict";var n=i("15922bb71c26e0956957"),t=function(e){return e&&e.__esModule?e:{default:e}}(n),o=$("#login-form"),a=o.validate({rules:{_username:{required:!0},_password:{required:!0}}});$("#login-form").keypress(function(e){13==e.which&&($(".js-btn-login").trigger("click"),e.preventDefault())}),$(".js-btn-login").click(function(e){a.form()&&($(e.currentTarget).button("loadding"),o.submit())}),$(".receive-modal").click(),$(".js-sts-login-link").length&&new t.default({element:$(".js-login-main")})}},["e821b9436177d7c7ef64"]);