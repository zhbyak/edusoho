webpackJsonp(["app/js/open-course-manage/lesson/index"],{"007f16bb16735f901b3c":function(e,s,t){"use strict";var n=t("33687ed90ec81811e04e");new(function(e){return e&&e.__esModule?e:{default:e}}(n).default)},"33687ed90ec81811e04e":function(e,s,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(s,"__esModule",{value:!0});var a=t("7ab4a89ebadbfdecc2bf"),o=n(a),i=t("4602c3f5fe7ad9e3e91d"),l=n(i),r=function(){function e(){(0,o.default)(this,e),this.$item=$(".js-open-course-lesson-item"),this.init()}return(0,l.default)(e,[{key:"init",value:function(){$(".js-file-delete-lesson").tooltip(),this.asyncLoadFiles(),this.bindEvent()}},{key:"bindEvent",value:function(){var e=this;this.$item.on("click",".js-publish-lesson-btn",function(s){return e.publishLesson(s)}),this.$item.on("click",".js-unpublish-lesson-btn",function(s){return e.cancelPublishLesson(s)}),this.$item.on("click",".js-delete-lesson-btn",function(s){return e.deleteLesson(s)}),$(".js-lesson-create-btn").on("click",function(s){return e.createLesson(s)})}},{key:"publishLesson",value:function(e){var s=$(e.target),t=Translator.trans("open_course.publish_lesson_hint");this.togglePublish(s,t)}},{key:"cancelPublishLesson",value:function(e){var s=$(e.target),t=Translator.trans("open_course.unpublish_success_hint");this.togglePublish(s,t)}},{key:"togglePublish",value:function(e,s){$.post(e.data("url"),function(e){$(".js-publish-lesson-btn, .js-delete-lesson-btn, .js-unpublish-lesson-btn").parent().toggleClass("hidden"),$(".js-unpublish-status").toggleClass("hidden"),cd.message({type:"success",message:s})})}},{key:"deleteLesson",value:function(e){var s=this,t=$(e.target);cd.confirm({title:Translator.trans("site.delete"),content:Translator.trans("open_course.lesson_delete_hint"),okText:Translator.trans("site.confirm"),cancelText:Translator.trans("site.close")}).on("ok",function(){$.post(t.data("url"),function(e){s.$item.remove(),$(".js-lesson-notify").show(),$(".js-lesson-create-btn").attr("disabled",!1),cd.message({type:"success",message:Translator.trans("open_course.lesson_delete_success_hint")})},"json")})}},{key:"createLesson",value:function(e){var s=$(e.target).data("url");$.get(s,function(e){e.result?cd.message({type:"warning",message:Translator.trans("open_course.add_lesson_hint")}):($("#modal").html(e),$("#modal").modal("show"))})}},{key:"asyncLoadFiles",value:function(){var e=this,s=$(".js-lesson-manage-panel").data("file-status-url"),t=this.$item.data("fileId");$.post(s,{ids:t},function(s){if(s&&0!=s.length){var t=s[0];"waiting"==t.convertStatus||"doing"==t.convertStatus?e.$item.find('span[data-role="mediaStatus"]').append("<span class='text-warning'>"+Translator.trans("open_course.file_format_conversion_hint")+"</span>"):"error"==t.convertStatus&&e.$item.find('span[data-role="mediaStatus"]').append("<span class='text-danger'>"+Translator.trans("open_course.file_format_conversion_failed_hint")+"</span>")}})}}]),e}();s.default=r}},["007f16bb16735f901b3c"]);